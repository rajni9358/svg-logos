
<p>In Python, currently thread priority is not directly supported by the <strong>threading</strong> module. unlike Java, Python does not support thread priorities, thread groups, or certain thread control mechanisms like destroying, stopping, suspending, resuming, or interrupting threads.</p>
<p>&nbsp;</p>
<p>Even thought Python threads are designed simple and is loosely based on <a href="/java/java_multithreading.htm">Java's threading</a> model. This is because of Python's Global Interpreter Lock (GIL), which manages Python threads.</p>
<p>However, you can simulate priority-based behavior using techniques such as sleep durations, custom scheduling logic within threads or using the additional module which manages task priorities.</p>
<h2>Setting the Thread Priority Using Sleep()</h2>
<p>You can simulate thread priority by introducing delays or using other mechanisms to control the execution order of threads. One common approach to simulate thread priority is by adjusting the sleep duration of your threads.</p>
<p>Threads with a lower priority sleep longer, and threads with a high priority sleep shorter.</p>
<h3>Example</h3>
<p>Here's a simple example to demonstrate how to customize the thread priorities using the delays in Python threads. In this example, Thread-2 completes before Thread-1 because it has a lower priority value, resulting in a shorter sleep time.</p>
<div class="code-wrapper">
<div class="code-header">
<div class="logo-side">&nbsp;</div>
<div class="button-side">
<div class="execute">&nbsp;</div>
<div class="open-compiler">Open Compiler</div>
</div>
</div>
<div class="code-mirror  language-python" style="outline: none; overflow-wrap: break-word; overflow-y: auto; white-space: pre-wrap;" contenteditable="plaintext-only" spellcheck="false"><span class="token keyword">import</span> threading <span class="token keyword">import</span> time <span class="token keyword">class</span> <span class="token class-name">DummyThread</span><span class="token punctuation">(</span>threading<span class="token punctuation">.</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> priority<span class="token punctuation">)</span><span class="token punctuation">:</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">)</span> self<span class="token punctuation">.</span>name <span class="token operator">=</span> name self<span class="token punctuation">.</span>priority <span class="token operator">=</span> priority <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> name <span class="token operator">=</span> self<span class="token punctuation">.</span>name time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>priority<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string"> thread with priority </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>priority<span class="token punctuation">}</span></span><span class="token string"> is running"</span></span><span class="token punctuation">)</span> <span class="token comment"># Creating threads with different priorities</span> t1 <span class="token operator">=</span> DummyThread<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'Thread-1'</span><span class="token punctuation">,</span> priority<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span> t2 <span class="token operator">=</span> DummyThread<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'Thread-2'</span><span class="token punctuation">,</span> priority<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># Starting the threads</span> t1<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span> t2<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># Waiting for both threads to complete</span> t1<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span> t2<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'All Threads are executed'</span><span class="token punctuation">)</span></div>
</div>
<p><strong>Output</strong></p>
<p>On executing the above program, you will get the following results &minus;</p>
<pre class="result notranslate">Thread-2 thread with priority 1 is running
Thread-1 thread with priority 4 is running
All Threads are executed
</pre>
<div class="inserted-div">&nbsp;</div>
<h2>Adjusting Python Thread Priority on Windows</h2>
<p>On Windows Operating system you can manipulate the thread priority using the <strong>ctypes</strong> module, This is one of the Pythons standard module used for interacting with the Windows API.</p>
<h3>Example</h3>
<p>This example demonstrates how to manually set the priority of threads in Python on a Windows system using the <strong>ctypes</strong> module.</p>
<div class="code-mirror  language-python" style="outline: none; overflow-wrap: break-word; overflow-y: auto; white-space: pre-wrap;" contenteditable="plaintext-only" spellcheck="false"><span class="token keyword">import</span> threading <span class="token keyword">import</span> ctypes <span class="token keyword">import</span> time <span class="token comment"># Constants for Windows API</span> w32 <span class="token operator">=</span> ctypes<span class="token punctuation">.</span>windll<span class="token punctuation">.</span>kernel32 SET_THREAD <span class="token operator">=</span> <span class="token number">0x20</span> PRIORITIZE_THE_THREAD <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">class</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span>threading<span class="token punctuation">.</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> start_event<span class="token punctuation">,</span> name<span class="token punctuation">,</span> iterations<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span> self<span class="token punctuation">.</span>start_event <span class="token operator">=</span> start_event self<span class="token punctuation">.</span>thread_id <span class="token operator">=</span> <span class="token boolean">None</span> self<span class="token punctuation">.</span>iterations <span class="token operator">=</span> iterations self<span class="token punctuation">.</span>name <span class="token operator">=</span> name <span class="token keyword">def</span> <span class="token function">set_priority</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> priority<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>is_alive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Cannot set priority for a non-active thread'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> thread_handle <span class="token operator">=</span> w32<span class="token punctuation">.</span>OpenThread<span class="token punctuation">(</span>SET_THREAD<span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>thread_id<span class="token punctuation">)</span> success <span class="token operator">=</span> w32<span class="token punctuation">.</span>SetThreadPriority<span class="token punctuation">(</span>thread_handle<span class="token punctuation">,</span> priority<span class="token punctuation">)</span> w32<span class="token punctuation">.</span>CloseHandle<span class="token punctuation">(</span>thread_handle<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token keyword">not</span> success<span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Failed to set thread priority:'</span><span class="token punctuation">,</span> w32<span class="token punctuation">.</span>GetLastError<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>thread_id <span class="token operator">=</span> w32<span class="token punctuation">.</span>GetCurrentThreadId<span class="token punctuation">(</span><span class="token punctuation">)</span> self<span class="token punctuation">.</span>start_event<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">while</span> self<span class="token punctuation">.</span>iterations<span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string"> running"</span></span><span class="token punctuation">)</span> start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">while</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start_time <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token keyword">pass</span> self<span class="token punctuation">.</span>iterations <span class="token operator">-=</span> <span class="token number">1</span> <span class="token comment"># Create an event to synchronize thread start</span> start_event <span class="token operator">=</span> threading<span class="token punctuation">.</span>Event<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># Create threads</span> thread_normal <span class="token operator">=</span> MyThread<span class="token punctuation">(</span>start_event<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'normal'</span><span class="token punctuation">,</span> iterations<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span> thread_high <span class="token operator">=</span> MyThread<span class="token punctuation">(</span>start_event<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'high'</span><span class="token punctuation">,</span> iterations<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment"># Start the threads</span> thread_normal<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span> thread_high<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># Adjusting priority of 'high' thread</span> thread_high<span class="token punctuation">.</span>set_priority<span class="token punctuation">(</span>PRIORITIZE_THE_THREAD<span class="token punctuation">)</span> <span class="token comment"># Trigger thread execution</span> start_event<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div>
<p><strong>Output</strong></p>
<p>While executing this code in your Python interpreter, you will get the following results &minus;</p>
<pre class="result notranslate">high running
normal running
high running
normal running
high running
normal running
high running
normal running
</pre>
<h2>Prioritizing Python Threads Using the Queue Module</h2>
<p>The <strong>queue</strong> module in Python's standard library is useful in threaded programming when information must be exchanged safely between multiple threads. The Priority Queue class in this module implements all the required locking semantics.</p>
<p>With a priority queue, the entries are kept sorted (using the <strong>heapq</strong> module) and the lowest valued entry is retrieved first.</p>
<p>The Queue objects have following methods to control the Queue &minus;</p>
<ul class="list">
<li>
<p><strong>get()</strong> &minus; The get() removes and returns an item from the queue.</p>
</li>
<li>
<p><strong>put()</strong> &minus; The put adds item to a queue.</p>
</li>
<li>
<p><strong>qsize()</strong> &minus; The qsize() returns the number of items that are currently in the queue.</p>
</li>
<li>
<p><strong>empty()</strong> &minus; The empty( ) returns True if queue is empty; otherwise, False.</p>
</li>
<li>
<p><strong>full()</strong> &minus; the full() returns True if queue is full; otherwise, False.</p>
</li>
</ul>
<div class="code-mirror  language-python" style="outline: none; overflow-wrap: break-word; overflow-y: auto; white-space: pre-wrap;" contenteditable="plaintext-only" spellcheck="false">queue<span class="token punctuation">.</span>PriorityQueue<span class="token punctuation">(</span>maxsize<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span></div>
<p>This is the Constructor for a priority queue. maxsize is an integer that sets the upper limit on the number of items that can be placed in the queue. If maxsize is less than or equal to zero, the queue size is infinite.</p>
<p>The lowest valued entries are retrieved first (the lowest valued entry is the one that would be returned by min(entries)). A typical pattern for entries is a tuple in the form &minus;</p>
<div class="code-mirror  language-python" style="outline: none; overflow-wrap: break-word; overflow-y: auto; white-space: pre-wrap;" contenteditable="plaintext-only" spellcheck="false"><span class="token punctuation">(</span>priority_number<span class="token punctuation">,</span> data<span class="token punctuation">)</span></div>
<h3>Example</h3>
<p>This example demonstrates the use of the <strong>PriorityQueue</strong> class in the <strong>queue</strong> module to manage task priorities between the two threads.</p>
<div class="code-wrapper">
<div class="code-header">
<div class="logo-side">&nbsp;</div>
<div class="button-side">
<div class="execute">&nbsp;</div>
<div class="open-compiler">Open Compiler</div>
</div>
</div>
<div class="code-mirror  language-python" style="outline: none; overflow-wrap: break-word; overflow-y: auto; white-space: pre-wrap;" contenteditable="plaintext-only" spellcheck="false"><span class="token keyword">from</span> time <span class="token keyword">import</span> sleep <span class="token keyword">from</span> random <span class="token keyword">import</span> random<span class="token punctuation">,</span> randint <span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread <span class="token keyword">from</span> queue <span class="token keyword">import</span> PriorityQueue queue <span class="token operator">=</span> PriorityQueue<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">def</span> <span class="token function">producer</span><span class="token punctuation">(</span>queue<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Producer: Running'</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># create item with priority</span> value <span class="token operator">=</span> random<span class="token punctuation">(</span><span class="token punctuation">)</span> priority <span class="token operator">=</span> randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> item <span class="token operator">=</span> <span class="token punctuation">(</span>priority<span class="token punctuation">,</span> value<span class="token punctuation">)</span> queue<span class="token punctuation">.</span>put<span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token comment"># wait for all items to be processed</span> queue<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span> queue<span class="token punctuation">.</span>put<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Producer: Done'</span><span class="token punctuation">)</span> <span class="token keyword">def</span> <span class="token function">consumer</span><span class="token punctuation">(</span>queue<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Consumer: Running'</span><span class="token punctuation">)</span> <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment"># get a unit of work</span> item <span class="token operator">=</span> queue<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> item <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span> <span class="token keyword">break</span> sleep<span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> queue<span class="token punctuation">.</span>task_done<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Consumer: Done'</span><span class="token punctuation">)</span> producer <span class="token operator">=</span> Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>producer<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span> producer<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span> consumer <span class="token operator">=</span> Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>consumer<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span> consumer<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span> producer<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span> consumer<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span></div>
</div>
<p><strong>Output</strong></p>
<p>On execution, It will produce the following output &minus;</p>
<pre class="result notranslate">Producer: Running
Consumer: Running
(0, 0.15332707626852804)
(2, 0.4730737391435892)
(2, 0.8679231358257962)
(3, 0.051924220435665025)
(4, 0.23945882716108446)
Producer: Done
Consumer: Done
</pre>
<div class="library-page-bottom-nav ">&nbsp;</div>
<div class="bottom-library-ads mt" style="margin: 5px;">
<div id="google-bottom-ads" class="google-bottom-ads">
<div style="width: 728px; height: 250px;">&nbsp;</div>
</div>
</div>
</div>