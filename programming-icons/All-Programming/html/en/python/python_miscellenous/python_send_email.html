<h2>Sending Email in Python</h2>
<p>You can send email in Python by using several libraries, but the most common ones are <strong>smtplib</strong> and <strong>email</strong>.</p>
<p>The "smtplib" module in Python defines an SMTP client session object that can be used to send mail to any Internet machine with an SMTP or ESMTP listener daemon. The email "package" is a library for managing email messages, including MIME and other RFC 2822-based message documents.</p>
<p>&nbsp;</p>
<div class="inserted-div">&nbsp;</div>
<h2>Python smptlib.SMTP() Function</h2>
<p>The Python smtplib.SMTP() function is used to create an SMTP client session object, which establishes a connection to an SMTP server. This connection allows you to send emails through the server.</p>
<h3>Setting Up an SMTP Server</h3>
<p>Before sending an email, you need to set up an SMTP server. Common SMTP servers include those provided by Gmail, Yahoo, or other mail service providers.</p>
<h3>Creating an SMTP Object</h3>
<p>To send an email, you need to obtain the object of SMTP class with the following function &minus;</p>
<div class="code-mirror  language-python" style="outline: none; overflow-wrap: break-word; overflow-y: auto; white-space: pre-wrap;" contenteditable="plaintext-only" spellcheck="false"><span class="token keyword">import</span> smtplib smtpObj <span class="token operator">=</span> smtplib<span class="token punctuation">.</span>SMTP<span class="token punctuation">(</span> <span class="token punctuation">[</span>host <span class="token punctuation">[</span><span class="token punctuation">,</span> port <span class="token punctuation">[</span><span class="token punctuation">,</span> local_hostname<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">)</span></div>
<p>Here is the detail of the parameters &minus;</p>
<ul class="list">
<li>
<p><strong>host</strong> &minus; This is the host running your SMTP server. You can specify IP address of the host or a domain name like <strong>tutorialspoint.com</strong>. This is an optional argument.</p>
</li>
<li>
<p><strong>port</strong> &minus; If you are providing host argument, then you need to specify a port, where SMTP server is listening. Usually this port would be 25.</p>
</li>
<li>
<p><strong>local_hostname</strong> &minus; If your SMTP server is running on your local machine, then you can specify just localhost as the option.</p>
</li>
</ul>
<p><strong>Example</strong></p>
<p>The following script connects to the SMTP server at "smtp.example.com" on port 25, optionally identifies and secures the connection, logs in (if required), sends an email, and then quits the session &minus;</p>
<div class="code-mirror  language-python" style="outline: none; overflow-wrap: break-word; overflow-y: auto; white-space: pre-wrap;" contenteditable="plaintext-only" spellcheck="false"><span class="token keyword">import</span> smtplib <span class="token comment"># Create an SMTP object and establish a connection to the SMTP server</span> smtpObj <span class="token operator">=</span> smtplib<span class="token punctuation">.</span>SMTP<span class="token punctuation">(</span><span class="token string">'smtp.example.com'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span> <span class="token comment"># Identify yourself to an ESMTP server using EHLO</span> smtpObj<span class="token punctuation">.</span>ehlo<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># Secure the SMTP connection</span> smtpObj<span class="token punctuation">.</span>starttls<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># Login to the server (if required)</span> smtpObj<span class="token punctuation">.</span>login<span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">,</span> <span class="token string">'password'</span><span class="token punctuation">)</span> <span class="token comment"># Send an email</span> from_address <span class="token operator">=</span> <span class="token string">'your_email@example.com'</span> to_address <span class="token operator">=</span> <span class="token string">'recipient@example.com'</span> message <span class="token operator">=</span> <span class="token triple-quoted-string string">"""\ Subject: Test Email This is a test email message. """</span> smtpObj<span class="token punctuation">.</span>sendmail<span class="token punctuation">(</span>from_address<span class="token punctuation">,</span> to_address<span class="token punctuation">,</span> message<span class="token punctuation">)</span> <span class="token comment"># Quit the SMTP session</span> smtpObj<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span></div>
<h2>The Python smtpd Module</h2>
<p>The Python <strong>smtpd</strong> module is used to create and manage a simple Mail Transfer Protocol (SMTP) server. This module allows you to set up an SMTP server that can receive and process incoming email messages, making it valuable for testing and debugging email functionalities within applications.</p>
<h3>Setting Up an SMTP Debugging Server</h3>
<p>The smtpd module comes pre-installed with Python and includes a local SMTP debugging server. This server is useful for testing email functionality without actually sending emails to specified addresses; instead, it prints the email content to the console.</p>
<p>Running this local server eliminates the need to handle message encryption or use credentials to log in to an email server.</p>
<h3>Starting the SMTP Debugging Server</h3>
<p>You can start the local SMTP debugging server using the following command in Command Prompt or terminal &minus;</p>
<div class="code-mirror  language-python" style="outline: none; overflow-wrap: break-word; overflow-y: auto; white-space: pre-wrap;" contenteditable="plaintext-only" spellcheck="false">python <span class="token operator">-</span>m smtpd <span class="token operator">-</span>c DebuggingServer <span class="token operator">-</span>n localhost<span class="token punctuation">:</span><span class="token number">1025</span></div>
<p><strong>Example</strong></p>
<p>The following example demonstrates how to send a dummy email using the smtplib functionality along with the local SMTP debugging server &minus;</p>
<div class="code-mirror  language-python" style="outline: none; overflow-wrap: break-word; overflow-y: auto; white-space: pre-wrap;" contenteditable="plaintext-only" spellcheck="false"><span class="token keyword">import</span> smtplib <span class="token keyword">def</span> <span class="token function">prompt</span><span class="token punctuation">(</span>prompt<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token builtin">input</span><span class="token punctuation">(</span>prompt<span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> fromaddr <span class="token operator">=</span> prompt<span class="token punctuation">(</span><span class="token string">"From: "</span><span class="token punctuation">)</span> toaddrs <span class="token operator">=</span> prompt<span class="token punctuation">(</span><span class="token string">"To: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Enter message, end with ^D (Unix) or ^Z (Windows):"</span><span class="token punctuation">)</span> <span class="token comment"># Add the From: and To: headers at the start!</span> msg <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">"From: %s\r\nTo: %s\r\n\r\n"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>fromaddr<span class="token punctuation">,</span> <span class="token string">", "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>toaddrs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token keyword">try</span><span class="token punctuation">:</span> line <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">except</span> EOFError<span class="token punctuation">:</span> <span class="token keyword">break</span> <span class="token keyword">if</span> <span class="token keyword">not</span> line<span class="token punctuation">:</span> <span class="token keyword">break</span> msg <span class="token operator">=</span> msg <span class="token operator">+</span> line <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Message length is"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span> server <span class="token operator">=</span> smtplib<span class="token punctuation">.</span>SMTP<span class="token punctuation">(</span><span class="token string">'localhost'</span><span class="token punctuation">,</span> <span class="token number">1025</span><span class="token punctuation">)</span> server<span class="token punctuation">.</span>set_debuglevel<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> server<span class="token punctuation">.</span>sendmail<span class="token punctuation">(</span>fromaddr<span class="token punctuation">,</span> toaddrs<span class="token punctuation">,</span> msg<span class="token punctuation">)</span> server<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span></div>
<p>In this example &minus;</p>
<ul class="list">
<li>
<p><strong>From</strong> &minus; You input the sender's email address (fromaddr).</p>
</li>
<li>
<p><strong>To</strong> &minus; You input the recipient's email address (toaddrs), which can be multiple addresses separated by spaces.</p>
</li>
<li>
<p><strong>Message</strong> &minus; You input the message content, terminated by ^D (Unix) or ^Z (Windows).</p>
</li>
</ul>
<p>The sendmail() method of "smtplib" sends the email using the specified sender, recipient(s), and message content to the local SMTP debugging server running on "localhost" at port "1025".</p>
<p><strong>Output</strong></p>
<p>When you run the program, the console outputs the communication between the program and the SMTP server. Meanwhile, the terminal running the SMTPD server displays the incoming message content, helping you debug and verify the email sending process.</p>
<pre class="result notranslate">python example.py
From: abc@xyz.com
To: xyz@abc.com
Enter message, end with ^D (Unix) or ^Z (Windows):
Hello World
^Z
</pre>
<p>The console reflects the following log &minus;</p>
<pre class="result notranslate">From: abc@xyz.com
reply: retcode (250); Msg: b'OK'
send: 'rcpt TO:&lt;xyz@abc.com&gt;\r\n'
reply: b'250 OK\r\n'
reply: retcode (250); Msg: b'OK'
send: 'data\r\n'
reply: b'354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;\r\n'
reply: retcode (354); Msg: b'End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;'
data: (354, b'End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;')
send: b'From: abc@xyz.com\r\nTo: xyz@abc.com\r\n\r\nHello
World\r\n.\r\n'
reply: b'250 OK\r\n'
reply: retcode (250); Msg: b'OK'
data: (250, b'OK')
send: 'quit\r\n'
reply: b'221 Bye\r\n'
reply: retcode (221); Msg: b'Bye'
</pre>
<p>The terminal in which the SMTPD server is running shows this <strong>output</strong> &minus;</p>
<pre class="result notranslate">---------- MESSAGE FOLLOWS ----------
b'From: abc@xyz.com'
b'To: xyz@abc.com'
b'X-Peer: ::1'
b''
b'Hello World'
------------ END MESSAGE ------------
</pre>
<h2>Sending an HTML e-mail using Python</h2>
<p>To send an HTML email using Python, you can use the <strong>smtplib</strong> library to connect to an SMTP server and the <strong>email.mime</strong> modules to construct and format your email content appropriately.</p>
<h3>Constructing the HTML Email Message</h3>
<p>When sending an HTML email, you need to specify certain headers and structure the message content accordingly to ensure it is recognized and rendered as HTML by the recipient's email client.</p>
<p><strong>Example</strong></p>
<p>Following is the example to send HTML content as an e-mail in Python &minus;</p>
<div class="code-mirror  language-python" style="outline: none; overflow-wrap: break-word; overflow-y: auto; white-space: pre-wrap;" contenteditable="plaintext-only" spellcheck="false"><span class="token keyword">import</span> smtplib <span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>multipart <span class="token keyword">import</span> MIMEMultipart <span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>text <span class="token keyword">import</span> MIMEText <span class="token comment"># Email content</span> sender <span class="token operator">=</span> <span class="token string">'from@fromdomain.com'</span> receivers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'to@todomain.com'</span><span class="token punctuation">]</span> <span class="token comment"># Create message container - the correct MIME type is multipart/alternative.</span> msg <span class="token operator">=</span> MIMEMultipart<span class="token punctuation">(</span><span class="token string">'alternative'</span><span class="token punctuation">)</span> msg<span class="token punctuation">[</span><span class="token string">'From'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'From Person &lt;from@fromdomain.com&gt;'</span> msg<span class="token punctuation">[</span><span class="token string">'To'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'To Person &lt;to@todomain.com&gt;'</span> msg<span class="token punctuation">[</span><span class="token string">'Subject'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'SMTP HTML e-mail test'</span> <span class="token comment"># HTML message content</span> html <span class="token operator">=</span> <span class="token triple-quoted-string string">"""\ &lt;html&gt; &lt;head&gt;&lt;/head&gt; &lt;body&gt; &lt;p&gt;This is an e-mail message to be sent in &lt;b&gt;HTML format&lt;/b&gt;&lt;/p&gt; &lt;p&gt;&lt;b&gt;This is HTML message.&lt;/b&gt;&lt;/p&gt; &lt;h1&gt;This is headline.&lt;/h1&gt; &lt;/body&gt; &lt;/html&gt; """</span> <span class="token comment"># Attach HTML content to the email</span> part2 <span class="token operator">=</span> MIMEText<span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token string">'html'</span><span class="token punctuation">)</span> msg<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>part2<span class="token punctuation">)</span> <span class="token comment"># Connect to SMTP server and send email</span> <span class="token keyword">try</span><span class="token punctuation">:</span> smtpObj <span class="token operator">=</span> smtplib<span class="token punctuation">.</span>SMTP<span class="token punctuation">(</span><span class="token string">'localhost'</span><span class="token punctuation">)</span> smtpObj<span class="token punctuation">.</span>sendmail<span class="token punctuation">(</span>sender<span class="token punctuation">,</span> receivers<span class="token punctuation">,</span> msg<span class="token punctuation">.</span>as_string<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Successfully sent email"</span><span class="token punctuation">)</span> <span class="token keyword">except</span> smtplib<span class="token punctuation">.</span>SMTPException <span class="token keyword">as</span> e<span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error: unable to send email. Error message: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></div>
<h2>Sending Attachments as an E-mail</h2>
<p>To send email attachments in Python, you can use the <strong>smtplib</strong> library to connect to an SMTP server and the <strong>email.mime</strong> modules to construct and format your email content, including attachments.</p>
<h3>Constructing an Email with Attachments</h3>
<p>When sending an email with attachments, you need to format the email correctly using MIME (Multipurpose Internet Mail Extensions). This involves setting the <strong>Content-Type</strong> header to <strong>multipart/mixed</strong> to denote that the email contains both text and attachments. Each part of the email (text and attachments) is separated by boundaries.</p>
<p><strong>Example</strong></p>
<p>Following is the example, which sends an email with a file <strong>/tmp/test.txt</strong> as an attachment &minus;</p>
<div class="code-mirror  language-python" style="outline: none; overflow-wrap: break-word; overflow-y: auto; white-space: pre-wrap;" contenteditable="plaintext-only" spellcheck="false"><span class="token keyword">import</span> smtplib <span class="token keyword">import</span> base64 filename <span class="token operator">=</span> <span class="token string">"/tmp/test.txt"</span> <span class="token comment"># Read a file and encode it into base64 format</span> fo <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> filecontent <span class="token operator">=</span> fo<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span> encodedcontent <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>filecontent<span class="token punctuation">)</span> <span class="token comment"># base64</span> sender <span class="token operator">=</span> <span class="token string">'webmaster@tutorialpoint.com'</span> reciever <span class="token operator">=</span> <span class="token string">'amrood.admin@gmail.com'</span> marker <span class="token operator">=</span> <span class="token string">"AUNIQUEMARKER"</span> body <span class="token operator">=</span><span class="token triple-quoted-string string">""" This is a test email to send an attachment. """</span> <span class="token comment"># Define the main headers.</span> part1 <span class="token operator">=</span> <span class="token triple-quoted-string string">"""From: From Person &lt;me@fromdomain.net&gt; To: To Person &lt;amrood.admin@gmail.com&gt; Subject: Sending Attachment MIME-Version: 1.0 Content-Type: multipart/mixed; boundary=%s --%s """</span> <span class="token operator">%</span> <span class="token punctuation">(</span>marker<span class="token punctuation">,</span> marker<span class="token punctuation">)</span> <span class="token comment"># Define the message action</span> part2 <span class="token operator">=</span> <span class="token triple-quoted-string string">"""Content-Type: text/plain Content-Transfer-Encoding:8bit %s --%s """</span> <span class="token operator">%</span> <span class="token punctuation">(</span>body<span class="token punctuation">,</span>marker<span class="token punctuation">)</span> <span class="token comment"># Define the attachment section</span> part3 <span class="token operator">=</span> <span class="token triple-quoted-string string">"""Content-Type: multipart/mixed; name=\"%s\" Content-Transfer-Encoding:base64 Content-Disposition: attachment; filename=%s %s --%s-- """</span> <span class="token operator">%</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> filename<span class="token punctuation">,</span> encodedcontent<span class="token punctuation">,</span> marker<span class="token punctuation">)</span> message <span class="token operator">=</span> part1 <span class="token operator">+</span> part2 <span class="token operator">+</span> part3 <span class="token keyword">try</span><span class="token punctuation">:</span> smtpObj <span class="token operator">=</span> smtplib<span class="token punctuation">.</span>SMTP<span class="token punctuation">(</span><span class="token string">'localhost'</span><span class="token punctuation">)</span> smtpObj<span class="token punctuation">.</span>sendmail<span class="token punctuation">(</span>sender<span class="token punctuation">,</span> reciever<span class="token punctuation">,</span> message<span class="token punctuation">)</span> <span class="token keyword">print</span> <span class="token string">"Successfully sent email"</span> <span class="token keyword">except</span> Exception<span class="token punctuation">:</span> <span class="token keyword">print</span> <span class="token string">"Error: unable to send email"</span></div>
<h2>Sending Email Using Gmail's SMTP Server</h2>
<p>To send an email using Gmail's SMTP server in Python, you need to set up a connection to <strong>smtp.gmail.com</strong> on port "587" with "TLS" encryption, authenticate using your Gmail credentials, construct the email message using Python's smtplib and email.mime libraries, and send it using the sendmail() method. Finally, close the SMTP connection with quit().</p>
<h3>Example</h3>
<p>Following is an example script that demonstrates how to send an email using Gmail's SMTP server &minus;</p>
<div class="code-mirror  language-python" style="outline: none; overflow-wrap: break-word; overflow-y: auto; white-space: pre-wrap;" contenteditable="plaintext-only" spellcheck="false"><span class="token keyword">import</span> smtplib <span class="token comment"># Email content</span> content <span class="token operator">=</span> <span class="token string">"Hello World"</span> <span class="token comment"># Set up SMTP connection to Gmail's SMTP server</span> mail <span class="token operator">=</span> smtplib<span class="token punctuation">.</span>SMTP<span class="token punctuation">(</span><span class="token string">'smtp.gmail.com'</span><span class="token punctuation">,</span> <span class="token number">587</span><span class="token punctuation">)</span> <span class="token comment"># Identify yourself to the SMTP server</span> mail<span class="token punctuation">.</span>ehlo<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># Start TLS encryption for the connection</span> mail<span class="token punctuation">.</span>starttls<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># Gmail account credentials </span> sender <span class="token operator">=</span> <span class="token string">'your_email@gmail.com'</span> password <span class="token operator">=</span> <span class="token string">'your_password'</span> <span class="token comment"># Login to Gmail's SMTP server</span> mail<span class="token punctuation">.</span>login<span class="token punctuation">(</span>sender<span class="token punctuation">,</span> password<span class="token punctuation">)</span> <span class="token comment"># Email details</span> recipient <span class="token operator">=</span> <span class="token string">'recipient_email@example.com'</span> subject <span class="token operator">=</span> <span class="token string">'Test Email'</span> <span class="token comment"># Construct email message with headers</span> header <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'To: </span><span class="token interpolation"><span class="token punctuation">{</span>recipient<span class="token punctuation">}</span></span><span class="token string">\nFrom: </span><span class="token interpolation"><span class="token punctuation">{</span>sender<span class="token punctuation">}</span></span><span class="token string">\nSubject: </span><span class="token interpolation"><span class="token punctuation">{</span>subject<span class="token punctuation">}</span></span><span class="token string">\n'</span></span> content <span class="token operator">=</span> header <span class="token operator">+</span> content <span class="token comment"># Send email</span> mail<span class="token punctuation">.</span>sendmail<span class="token punctuation">(</span>sender<span class="token punctuation">,</span> recipient<span class="token punctuation">,</span> content<span class="token punctuation">)</span> <span class="token comment"># Close SMTP connection</span> mail<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span></div>
<p>Before running above script, sender's gmail account must be configured to allow access for 'less secure apps'. Visit following link.</p>
<p><a href="https://myaccount.google.com/lesssecureapps" target="_blank" rel="nofollow">https://myaccount.google.com/lesssecureapps </a> Set the shown toggle button to ON.</p>
<p><img src="https://www.tutorialspoint.com/python/images/toggle_button.jpg" alt="toggle button" /></p>
<p>If everything goes well, execute the above script. The message should be delivered to the recipient's inbox.</p>
<div class="library-page-bottom-nav ">&nbsp;</div>
<div class="bottom-library-ads mt" style="margin: 5px;">
<div id="google-bottom-ads" class="google-bottom-ads">
<div style="width: 728px; height: 250px;">&nbsp;</div>
</div>
</div>